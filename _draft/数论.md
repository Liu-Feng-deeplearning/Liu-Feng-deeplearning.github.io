# 数论

## r2b

存在一个原根 $g$，对每个整数 $a$, 存在唯一正整数$m$, s.t. $a = g^m \ (mod P)$

使用一个额外的数组来记录 $gp[m]=i$, 如果 $a_i = g^m (mod P)$

使用另一个额外的数组 $good[k]=1 \ if \  gp[k]<L \ mod(P) \ else \ 0$

构造多项式为 $A(x) = A_0 + A_{1}x + A_{2}x^2 ...$，其中 
$A_i$ 表示 $a$ 中可表示为 $g^i$ 元素的数目

$B(x)$ 同理。

那么 $C(x) = A(x) B(x) = c_0 + c_{1}x + c_{2}x^2 ...$，
则 $C(x)$ 中 $x_k$ 的系数为 
$c_k = A_0 B_k + A_1 B_{k-1} ...$ 为 $g_0 g_k$ 的元素个数 + $g_1 g_{k-1}$ 的元素个数 ... = 
所有乘积为 $g^k$ 的元素个数

最终计算 $res = \Sigma good[k]*c[k]$ 即可

核心步骤: 通过 NTT，可以将多项式乘法转成加法，从而在 $O(N)$ 内完成。


